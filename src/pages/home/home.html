<ion-header>
    <ion-navbar>
        <ion-title>
          Connect Club
        </ion-title>
        <ion-buttons end>
            <button ion-button (click)="calluserdetails()">
                <ion-icon name="person" style="color: white"></ion-icon>
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header>

<ion-content class="home">

    <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content
          pullingIcon="arrow-dropdown"
          pullingText="Pull to refresh"
          refreshingSpinner="circles"
          refreshingText="Refreshing...">
        </ion-refresher-content>
    </ion-refresher>

    <ion-card>      
        <div>
            <ion-row>
                <ion-col col-2>
                    <ion-avatar item-left>
                        <img [src]="profileimage" *ngIf="profileimage" style="height: 40px; width: 40px">
                    </ion-avatar>                                                     
                </ion-col>
                <ion-col col-10 (click)="onCreatePostClick()"> 
                    <ion-item>
                    <button  ion-button full clear style="text-transform: none" >
                         Give a challenge to all club and player..
                    </button>
                    </ion-item>
                </ion-col>
            </ion-row>
        </div>
    </ion-card>

    <ion-card style="height: 220px">
        <ion-item style="border-bottom: 1px solid #e0e0e0">
            Clubs to follow:
        </ion-item>

        <ion-scroll scrollX="true" style="height: 180px;" >
            <ion-card class="scroll-item" *ngFor="let club of clubs, let i = index" style="height: 100%; width: 100px">
                <ion-label style="margin: 0px">
                    <ion-icon name="more" style="float: right; padding-top: 5px; padding-right: 10px" (click)="onMoreClick($event)"></ion-icon>
                </ion-label>

                <ion-row style="height: 60px">
                    <button ion-button full clear style="height: 100%">                        
                        <ion-avatar>
                            <img style="width: 60px; height: 60px; border-radius: 30px " [src]="club.profileimage" *ngIf="club.profileimage">
                        </ion-avatar>
                    </button>  
                </ion-row>
                <ion-row>
                    <button ion-button full clear style="color: black">
                        {{club.name}}
                    </button>
                </ion-row>
                <ion-row style="background-color: #f7f7f7">
                    <ion-col>
                        <button *ngIf="!iffollowing[i]" (click)="follow(i)" ion-button full clear style="font-size: 1.2rem; color: black">                            
                            <ion-icon name="person-add"></ion-icon><span style="width: 5px"></span>
                            Follow
                        </button>
                        <button *ngIf="iffollowing[i]" (click)="unfollow(i)" ion-button full clear color="danger" style="font-size: 1.2rem">                            
                            <ion-icon name="person"></ion-icon><span style="width: 5px"></span>
                            Unfollow
                        </button>
                    </ion-col>
                </ion-row>
            </ion-card>
        </ion-scroll>
    </ion-card>

    <!-- User Feed -->
    <ion-list *ngFor="let post of posts, let i = index">

        <ion-card *ngIf="post.posttype == 'tournament'" >
            <ion-item>
                <ion-avatar item-left>
                    <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">
                    {{post.username || "Forgot to edit name"}}
                </h2>
                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp;{{posttime[i]}}</p>
            </ion-item>

            <ion-item>
                <p>Organising a <b>{{post.sporttype}}</b> tournament on <b>{{post.eventdate}}</b> at {{post.eventvenue || "our club ground"}}</p> 
            </ion-item>
            <ion-row style="height: 250px; width: 100%; border-bottom: 1px solid #e0e0e0">
                <img [src]="post.imageurl" *ngIf="post.imageurl">
            </ion-row>
                
            <ion-item style="background-color: #096682; color: white">
                <ion-row>
                    <ion-col color="secondary"> Entry Fee: {{post.entryfee}} </ion-col>
                    <ion-col color="secondary"> Prize: {{post.prize}} </ion-col>
                </ion-row>
            </ion-item>
            <ion-row *ngIf="post.userId != authuid" style="padding: 5px 0px">
                <ion-col>
                    <button ion-button icon-left full clear>
                        <ion-icon name="person"></ion-icon>
                        <div>{{post.participating}} Going</div>
                    </button>
                </ion-col>
                <ion-col>
                    <button ion-button icon-left full clear>
                        <ion-icon name="car"></ion-icon>
                        <div>1.4km</div>
                    </button>
                </ion-col>
                <ion-col center text-center>
                    <button ion-button full (click)="onRulesClick(post.rules,post.participating,post.$key,post.userId)">
                        Rules <span style="width: 5px"></span>
                        <ion-icon name="arrow-round-forward"></ion-icon>
                    </button>
                </ion-col>
            </ion-row>
            <button *ngIf="post.userId == authuid" (click)="seeParticipants(post.$key)" ion-button block outline style="text-transform: none;margin-top: 20px">See all participants</button>
        </ion-card>

        <ion-card *ngIf="post.posttype == 'hiring'" >
            <ion-item>
                <ion-avatar item-left>
                    <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">{{post.username || "Forgot to edit name"}}</h2>

                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp; {{posttime[i]}} </p>
            </ion-item>
            <ion-item>
                <p>Organising a <b>{{post.sporttype}} Trial for Hiring Players</b> on {{post.eventdate}}</p>
                <p>Be present at {{post.eventvenue || "our club ground"}}</p>
            </ion-item>
            <ion-row style="height: 250px; width: 100%">          
                <img [src]="post.imageurl" *ngIf="post.imageurl">
            </ion-row>
   
            <ion-item>
                <ion-row>
                    <ion-col> Trial Date: {{post.eventdate}} </ion-col>
                    <ion-col color="danger"> **First come First </ion-col>
                </ion-row>
            </ion-item>
            <ion-row *ngIf="post.userId != authuid">
                <ion-col col-4>
                    <button ion-button icon-left clear small>
                        <ion-icon name="person"></ion-icon>
                        <div>{{post.participating}} Going</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button ion-button icon-left clear small>
                        <ion-icon name="car"></ion-icon>
                        <div>1.4km</div>
                    </button>
                </ion-col>
                <ion-col center text-center col-4>
                    <button ion-button block outline (click)="onCriteriaClick(post.criteria,post.participating,post.$key,post.userId)">
                        Criteria <span style="width: 5px"></span>
                        <ion-icon name="arrow-round-forward"></ion-icon>
                    </button>
                </ion-col>
            </ion-row>
            <button *ngIf="post.userId == authuid" (click)="seeParticipants(post.$key,post.participating)" ion-button block outline style="text-transform: none;margin-top: 20px">See all participants</button>
        </ion-card>
        

        <ion-card *ngIf="post.posttype == 'image'" > 
            <ion-item>
                <ion-avatar item-left>
                    <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">{{post.username || "Forgot to edit name"}}</h2>

                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp; {{posttime[i]}} </p>
            </ion-item>
            <ion-item>
                <p>{{post.title}}</p>
            </ion-item>
            <div>                
                <img [src] ="post.imageurl" *ngIf="post.imageurl" style="padding: 5px; height: 250px">
                <video width="320" height="240" autoplay *ngIf="post.videourl">
                    <source [src]="post.videourl" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <ion-row>
                <ion-col col-4>
                    <button (click)="likePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-up" [class.gray-color]="liked[i] == false" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="liked[i] == false">{{post.likes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button (click)="dislikePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-down" [class.gray-color]="disliked[i] == false" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="disliked[i] == false">{{post.dislikes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="chatboxes"></ion-icon>
                        <span style="width: 5px"></span>
                        <div>{{post.comments}} </div>
                    </button>
                </ion-col>
            </ion-row>
        </ion-card>
        <ion-card *ngIf="post.posttype == 'youtube'" > 
            <ion-item>
                <ion-avatar item-left>
                    <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">{{post.username || "Forgot to edit name"}}</h2>

                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp; {{posttime[i]}} </p>
            </ion-item>
            <ion-item>
                <p>{{post.title}}</p>
            </ion-item>
            <div>                
                <iframe width="100%" height="250" [src]="post.youtubelink | youtube" frameborder="0" allowfullscreen></iframe>
            </div>
            <ion-row>
                <ion-col col-4>
                    <button (click)="likePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-up" [class.gray-color]="liked[i] == false" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="liked[i] == false">{{post.likes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button (click)="dislikePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-down" [class.gray-color]="disliked[i] == false" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="disliked[i] == false">{{post.dislikes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="chatboxes"></ion-icon>
                        <span style="width: 5px"></span>
                        <div>{{post.comments}} </div>
                    </button>
                </ion-col>
            </ion-row>
        </ion-card>

        <ion-card *ngIf="post.posttype == 'score' && post.sporttype == 'cricket' && post.crickettype == 'odi'" >
            <ion-item>
                <ion-avatar item-left>
                   <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">{{post.username || "Forgot to edit name"}}</h2>

                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp; {{posttime[i]}} </p>
            </ion-item>
            <ion-title>
                 Cricket Score Update:
            </ion-title>
            <ion-item>
                <ion-label>{{post.teamone}} vs {{post.teamtwo}}</ion-label>
            </ion-item>
            <ion-item *ngIf="post.tosswon == 'teamone'">
                <ion-label>{{post.teamone}} won toss and elected {{post.elected}} first </ion-label>
            </ion-item>
            <ion-item *ngIf="post.tosswon == 'teamtwo'">
                <ion-label>{{post.teamtwo}} won toss and elected {{post.elected}} first </ion-label>
            </ion-item>
            <button *ngIf="(post.tosswon == 'teamone' && post.elected == 'batting') || (post.tosswon == 'teamtwo' && post.elected == 'bowling')" ion-button clear full style="text-transform: none">
                {{post.teamone}} <span style="width: 5px"></span>
                <ion-icon name="happy"></ion-icon>
            </button>
            <button *ngIf="(post.tosswon == 'teamtwo' && post.elected == 'batting') || (post.tosswon == 'teamone' && post.elected == 'bowling')" ion-button clear full style="text-transform: none">
                {{post.teamtwo}} <span style="width: 5px"></span>
                <ion-icon name="happy"></ion-icon>
            </button>
            <ion-row>
                <ion-col col-3></ion-col>
                <ion-col col-5>Runs Scored :</ion-col>
                <ion-col col-3>{{post.runsscored}} </ion-col>
                <ion-col col-1></ion-col>
            </ion-row>
            <ion-row>
                <ion-col col-3></ion-col>
                <ion-col col-5>Wicket Lost :</ion-col>
                <ion-col col-3>{{post.wickets}} </ion-col>
                <ion-col col-1></ion-col>
            </ion-row>
            <ion-row>
                <ion-col col-3></ion-col>
                <ion-col col-5>Overs Bowled :</ion-col>
                <ion-col col-3>{{post.overs}} </ion-col>
                <ion-col col-1></ion-col>
            </ion-row>
            <br>
            <ion-row>
                <ion-col col-4>
                    <button (click)="likePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-up" [class.gray-color]="liked[i] == 0" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="liked[i] == 0">{{post.likes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button (click)="dislikePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-down" [class.gray-color]="disliked[i] == 0"></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="disliked[i] == 0">{{post.dislikes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="chatboxes"></ion-icon>
                        <span style="width: 5px"></span>
                        <div>{{post.comments}} </div>
                    </button>
                </ion-col>
            </ion-row>
        </ion-card>

        <ion-card *ngIf="post.posttype == 'score' && post.sporttype == 'cricket' && post.crickettype == 'test'" >
            <ion-item>
                <ion-avatar item-left>
                   <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">{{post.username || "Forgot to edit name"}}</h2>

                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp; {{posttime[i]}} </p>
            </ion-item>
            <ion-title>
                 Test cricket Score Update:
            </ion-title>
            <ion-item>
                <ion-label><b>{{post.testno}}</b> between <b>{{post.teamone}}</b> and <b>{{post.teamtwo}}</b></ion-label>
            </ion-item>
            
            <button ion-button full clear style="text-transform: none" *ngIf="post.battingteam == 'teamone'">{{post.inningsno}} of {{post.teamone}} </button>
            <button ion-button full clear style="text-transform: none" *ngIf="post.battingteam == 'teamtwo'">{{post.inningsno}} of {{post.teamtwo}} </button>
            <ion-row>
                <ion-col col-3></ion-col>
                <ion-col col-5>Runs Scored :</ion-col>
                <ion-col col-3>{{post.runsscored}} </ion-col>
                <ion-col col-1></ion-col>
            </ion-row>
            <ion-row>
                <ion-col col-3></ion-col>
                <ion-col col-5>Wicket Lost :</ion-col>
                <ion-col col-3>{{post.wickets}} </ion-col>
                <ion-col col-1></ion-col>
            </ion-row>
            <br>
            <ion-row>
                <ion-col col-4>
                    <button (click)="likePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-up" [class.gray-color]="liked[i] == 0" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="liked[i] == 0">{{post.likes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button (click)="dislikePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-down" [class.gray-color]="disliked[i] == 0"></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="disliked[i] == 0">{{post.dislikes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="chatboxes"></ion-icon>
                        <span style="width: 5px"></span>
                        <div>{{post.comments}} </div>
                    </button>
                </ion-col>
            </ion-row>
        </ion-card>
        <ion-card *ngIf="post.posttype == 'score' && post.sporttype == 'football'" >
            <ion-item>
                <ion-avatar item-left>
                   <img [src]="post.userimage" *ngIf="post.userimage">
                </ion-avatar>
                <ion-icon name="more" item-right (click)="onMoreClick($event)"></ion-icon>
                <h2 (click)="onUsernameClick(post.userId)">{{post.username || "Forgot to edit name"}}</h2>

                <p><ion-icon name="pin"></ion-icon><span> </span>Kolkata &nbsp; {{posttime[i]}} </p>
            </ion-item>
            <ion-title>
                 Football Score Update:
            </ion-title>
            <ion-item>
                <ion-row style="font-weight: 400">
                    <ion-col>{{post.teamone}}</ion-col>
                    <ion-col col-2>vs</ion-col> 
                    <ion-col>{{post.teamtwo}}</ion-col>
                </ion-row>
            </ion-item>
            <div style="border: 1px solid gray">
                <div>
                    <ion-row style="font-weight: 100">
                        <ion-col col-4 style="padding-left: 11px">Goal Scored :</ion-col>
                        <ion-col col-2>{{post.goalone}} </ion-col>
                        <ion-col col-4 style="padding-left: 11px">Goal Scored :</ion-col>
                        <ion-col col-2>{{post.goaltwo}} </ion-col>
                    </ion-row>
                </div>
                <div>
                    <ion-row style="font-weight: 100">
                        <ion-col col-4 style="padding-left: 11px">Yellow Card :</ion-col>
                        <ion-col col-2>{{post.yellocardone}} </ion-col>
                        <ion-col col-4 style="padding-left: 11px">Yellow Card :</ion-col>
                        <ion-col col-2>{{post.yellowcardtwo}} </ion-col>
                    </ion-row>
                </div>
                <div>
                    <ion-row style="font-weight: 100">
                        <ion-col col-4 style="padding-left: 11px">Red Card :</ion-col>
                        <ion-col col-2>{{post.redcardone}} </ion-col>
                        <ion-col col-4 style="padding-left: 11px">Red Card :</ion-col>
                        <ion-col col-2>{{post.redcardtwo}} </ion-col>
                    </ion-row>
                </div>
                <div>
                    <ion-row style="font-weight: 100">
                        <ion-col style="padding-left: 11px">Scorer :</ion-col>
                        <ion-col>{{post.goalscorerone}} </ion-col>
                        <ion-col style="padding-left: 11px">Scorer :</ion-col>
                        <ion-col>{{post.goalscorertwo}} </ion-col>
                    </ion-row>
                </div>
            </div>
            <br>
            <ion-row>
                <ion-col col-4>
                    <button (click)="likePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-up" [class.gray-color]="liked[i] == 0" ></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="liked[i] == 0">{{post.likes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button (click)="dislikePost(post.$key,i)" ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="thumbs-down"  [class.gray-color]="disliked[i] == 0"></ion-icon>
                        <span style="width: 5px"></span>
                        <div [class.gray-color]="disliked[i] == 0">{{post.dislikes}}</div>
                    </button>
                </ion-col>
                <ion-col col-4>
                    <button ion-button icon-center full clear class="scorebutton">
                        <ion-icon name="chatboxes"></ion-icon>
                        <span style="width: 5px"></span>
                        <div>{{post.comments}} </div>
                    </button>
                </ion-col>
            </ion-row>
        </ion-card>
    </ion-list>

</ion-content>



 